<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h1>欢迎来到授权页面</h1>
  <button onclick="topermission()">点击进行授权</button>
  <p>您的授权链接为：</p>
  <p id="url"></p>

  <script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.min.js"></script>
  <script type="text/javascript">
    let url = document.getElementById("url");
    let herf = window.location.href;
    url.innerHTML = herf

    function Post(url,params){
      return new Promise((resolve,reject)=>{
        $.ajax({
          type: 'POST',
          contentType:'application/x-www-form-urlencoded',
          url: url,
          data: JSON.stringify(params),
          success: res => {
            console.log(res);
          },
        })
      });
    }

    async function topermission(argument) {
      let url = document.getElementById("url");
      let herf = window.location.href;
      const res = await Post("http://127.0.0.1:8000/shop/getpermission",{})
      if (res.rtCode == "0000") {
        alert(res.rtMsg)
      } else {
        alert(res.rtMsg)
      }

    }

  </script>
</body>
</html>